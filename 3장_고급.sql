// 0715
//  실습하기 3.1 테이블 생성 및 데이터 입력

CREATE TABLE EMP(
    EMPNO NUMBER(4) PRIMARY KEY,
    NAME VARCHAR2(20) NOT NULL,
    GENDER CHAR(1) NOT NULL,
    JOB VARCHAR(10) NOT NULL,
    DEPNO NUMBER (2),
    REGDATE DATE NOT NULL   
);

CREATE TABLE DEPT(
    DEPTNO NUMBER (2) PRIMARY KEY,
    DNAME VARCHAR2(20) NOT NULL,
    DTEL VARCHAR2(12) NOT NULL
);
    DROP TABLE DEPT;
CREATE TABLE SALE(
    NO NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    EMPNO NUMBER (4) NOT NULL,
    YEAR NUMBER (4) NOT NULL,
    MONTH NUMBER (2) NOT NULL,
    PRICE NUMBER(10)
);
    
// 직원 테이블 데이터
    INSERT INTO EMP VALUES (1001, '김유신', 'M', '사원', 10, SYSDATE);
    INSERT INTO EMP VALUES (1002, '김춘추', 'M', '대리', 20, SYSDATE);
    INSERT INTO EMP VALUES (1003, '장보고', 'M', '과장', 10, SYSDATE);
    INSERT INTO EMP VALUES (1004, '강감찬', 'M', '부장', 30, SYSDATE);
    INSERT INTO EMP VALUES (1005, '신사임당', 'F', '대리', 20, SYSDATE);
    INSERT INTO EMP VALUES (1006, '이황', 'M', '사원', 40, SYSDATE);
    INSERT INTO EMP VALUES (1007, '이이', 'M', '과장', 20, SYSDATE);
    INSERT INTO EMP VALUES (1008, '이순신', 'M', '사원', NULL, SYSDATE);
    INSERT INTO EMP VALUES (1009, '허난설헌', 'F', '사원', NULL, SYSDATE);
    INSERT INTO EMP VALUES (1010, '정약용', 'M', '대리', 50, SYSDATE);
    
    // 부서 테이블 데이터
    INSERT INTO DEPT (DEPTNO, DNAME, DTEL) VALUES (10, '영업1부', '051-511-1000');
    INSERT INTO DEPT (DEPTNO, DNAME, DTEL) VALUES (20, '영업2부', '051-511-2000');
    INSERT INTO DEPT (DEPTNO, DNAME, DTEL) VALUES (30, '영업3부', '051-511-3000');
    INSERT INTO DEPT (DEPTNO, DNAME, DTEL) VALUES (40, '영업4부', '051-511-4000');
    INSERT INTO DEPT (DEPTNO, DNAME, DTEL) VALUES (50, '영업지부', '051-511-5000');
    
// 매출 테이블 데이터 
    INSERT INTO SALE (EMPNO, YEAR, MONTH,PRICE) VALUES (1001, 2023, 1, 98100);
    INSERT INTO SALE (EMPNO, YEAR, MONTH,PRICE) VALUES (1002, 2023, 1, 136000);
    INSERT INTO SALE (EMPNO, YEAR, MONTH,PRICE) VALUES (1003, 2023, 1, 80000);
    INSERT INTO SALE (EMPNO, YEAR, MONTH,PRICE) VALUES (1004, 2023, 1, 78000);
    INSERT INTO SALE (EMPNO, YEAR, MONTH,PRICE) VALUES (1005, 2023, 1, NULL);
    
    INSERT INTO SALE (EMPNO, YEAR, MONTH,PRICE) VALUES (1001, 2023, 2, 23500);
    INSERT INTO SALE (EMPNO, YEAR, MONTH,PRICE) VALUES (1002, 2023, 2, 126000);
    INSERT INTO SALE (EMPNO, YEAR, MONTH,PRICE) VALUES (1003, 2023, 2, 18500);
    INSERT INTO SALE (EMPNO, YEAR, MONTH,PRICE) VALUES (1005, 2023, 2, 19000);
    INSERT INTO SALE (EMPNO, YEAR, MONTH,PRICE) VALUES (1010, 2023, 2, 53000);
    
    INSERT INTO SALE (EMPNO, YEAR, MONTH,PRICE) VALUES (1001, 2024, 1, 24000);
    INSERT INTO SALE (EMPNO, YEAR, MONTH,PRICE) VALUES (1002, 2024, 1, 109000);
    INSERT INTO SALE (EMPNO, YEAR, MONTH,PRICE) VALUES (1003, 2024, 1, 80000);
    INSERT INTO SALE (EMPNO, YEAR, MONTH,PRICE) VALUES (1004, 2024, 1, NULL);
    INSERT INTO SALE (EMPNO, YEAR, MONTH,PRICE) VALUES (1007, 2024, 1, 24000);
    
    INSERT INTO SALE (EMPNO, YEAR, MONTH,PRICE) VALUES (1002, 2024, 2, 160000);
    INSERT INTO SALE (EMPNO, YEAR, MONTH,PRICE) VALUES (1003, 2024, 2, 101000);
    INSERT INTO SALE (EMPNO, YEAR, MONTH,PRICE) VALUES (1004, 2024, 2, 43000);
    INSERT INTO SALE (EMPNO, YEAR, MONTH,PRICE) VALUES (1005, 2024, 2, 24000);
    INSERT INTO SALE (EMPNO, YEAR, MONTH,PRICE) VALUES (1006, 2024, 2, 109000);
    
SELECT * FROM EMP;
SELECT * FROM SALE;
SELECT * FROM DEPT;

    SELECT * FROM EMP WHERE NAME != '김춘추';
    SELECT * FROM EMP WHERE NAME <> '김춘추';
    
    SELECT * FROM EMP WHERE JOB = '사원' OR JOB = '대리';
    SELECT * FROM EMP WHERE JOB IN ('사원','대리');
    
    SELECT *FROM EMP WHERE NAME LIKE '김%';
    SELECT * FROM EMP WHERE NAME LIKE '%신';
    SELECT * FROM EMP WHERE NAME LIKE '김__';
    SELECT * FROM EMP WHERE NAME LIKE '이_';
    SELECT * FROM EMP WHERE NAME LIKE '이__';
    SELECT * FROM EMP WHERE EMPNO >= '1001';
    SELECT * FROM SALE WHERE PRICE >= 50000 AND PRICE < 100000 AND MONTH = 1;
    SELECT * FROM SALE WHERE MONTH IN (1,2);
    
    //2.2
    SELECT * FROM SALE ORDER BY PRICE;
    SELECT * FROM SALE ORDER BY PRICE ASC;
    SELECT * FROM SALE ORDER BY YEAR DESC;
    SELECT * FROM EMP ORDER BY NAME ASC;
    SELECT * FROM EMP ORDER BY REGDATE ASC;
    
    SELECT * FROM SALE WHERE PRICE > 50000 ORDER BY PRICE DESC;
    SELECT * FROM SALE WHERE PRICE > 50000 ORDER BY YEAR DESC, MONTH, PRICE DESC;
    
    SELECT * FROM SALE FETCH FIRST 3 ROWS ONLY;
    SELECT * FROM SALE OFFSET 0 ROWS FETCH NEXT 3 ROWS ONLY;
    SELECT * FROM SALE OFFSET 1 ROWS FETCH NEXT 2 ROWS ONLY;
    SELECT * FROM SALE OFFSET 5 ROWS FETCH NEXT 3 ROWS ONLY;
    SELECT * FROM SALE WHERE PRICE > 50000 ORDER BY YEAR DESC FETCH FIRST 3 ROWS ONLY;
    SELECT * FROM SALE WHERE PRICE > 50000 ORDER BY YEAR DESC, MONTH, PRICE DESC
    FETCH FIRST 5 ROWS ONLY;
    
    // 2.3
    SELECT DISTINCT DEPNO FROM EMP;
    SELECT DISTINCT JOB, DEPNO FROM EMP;
    
    SELECT EMPNO AS 사번, NAME AS 이름, GENDER AS 성별 FROM EMP;
    SELECT EMPNO E, NAME N, GENDER G FROM EMP;
    
    //실습하기 3.1
SELECT SUM(PRICE) AS 합계 FROM SALE;
SELECT AVG(PRICE) AS 평균 FROM SALE;
SELECT MAX(PRICE) AS "최대값" FROM SALE;
SELECT MIN(PRICE) AS "최소값" FROM SALE;
SELECT COUNT(*) AS 직원수 FROM EMP;
SELECT COUNT(EMPNO) AS 직원수 FROM EMP;
SELECT COUNT(DEPNO) AS 부서수 FROM EMP;

SELECT CEIL(1.2) FROM DUAL; //올림
SELECT CEIL(1.8) FROM DUAL;
SELECT FLOOR(1.2) FROM DUAL;    //내림
SELECT FLOOR(1.8) FROM DUAL;
SELECT ROUND(1.2) FROM DUAL;    //반올림
SELECT ROUND(1.8) FROM DUAL;
SELECT DBMS_RANDOM.VALUE FROM DUAL;
SELECT CEIL(DBMS_RANDOM.VALUE*10) FROM DUAL;

// 3.2 다양한 SQL 문자함수
    SELECT 'HELLO ORACLE!', LENGTH('HELLO ORACLE!') FROM DUAL;
    SELECT 'HELLO ORACLE!',
    SUBSTR('HELLO ORACLE!', 1, 3),
    SUBSTR('HELLO ORACLE!', 3, 2),
    SUBSTR ('HELLO ORACLE!', 5)
    FROM DUAL;
    
    SELECT INSTR('HELLO ORACLE!', 'L') AS INSTR_1,
    INSTR('HELLO ORACLE!','L',-1) AS INSTR_2 FROM DUAL;
    
    SELECT '010-1234-5678', REPLACE('010-1234-5678','-','')FROM DUAL;
    
SELECT
    LPAD('ORALE',10,'#') AS LPAD,
    RPAD('ORACLE',10,'*') FROM DUAL;
    SELECT CONCAT(EMPNO,NAME) FROM EMP WHERE NAME='이순신';
    SELECT EMPNO || NAME FROM EMP WHERE NAME='정약용';
    SELECT '[ _ORACLE_ ]' AS BEFORE, '[' || TRIM(' _ORACLE_ ') || ']' AS TRIM FROM DUAL;
    
    SELECT SYSDATE, SYSDATE -1, SYSDATE +1 FROM DUAL;
    SELECT ADD_MONTHS(SYSDATE, 1), ADD_MONTHS(SYSDATE, -1) FROM DUAL;
    SELECT MONTHS_BETWEEN(DATE '2025-07-13', DATE '2024-07-13') AS 개월차 FROM DUAL;
    SELECT NEXT_DAY(SYSDATE,'월요일') AS 다음_월요일 FROM DUAL;
    SELECT TO_CHAR(SYSDATE, 'YYYY') AS YYYY,
    TO_CHAR(SYSDATE, 'MM') AS MM,
    TO_CHAR(SYSDATE, 'DD') AS DD,
    TO_CHAR(SYSDATE, 'HH24') AS HH24,
    TO_CHAR(SYSDATE, 'MI') AS MI,
    TO_CHAR(SYSDATE, 'SS') AS SS,
    TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') AS 날자시간 FROM DUAL;
    
    INSERT INTO EMP VALUES (1011, '안중근' ,'M', '부장', 30, TO_CHAR(SYSDATE, 'YYYY/MM/DD'));
    
    SELECT TO_DATE('20250714', 'YY/MM/DD') AS 날짜1,
    TO_DATE('250714','YY-MM-DD')AS 날짜2,
    TO_DATE(SYSDATE, 'YYYY/MM/DD HH24:MI:SS')AS 날짜시간
    FROM DUAL;
    
    INSERT INTO EMP VALUES (1012,'유관순','F','차장',20, SYSDATE);
    INSERT INTO EMP VALUES (1013,'윤봉길','M','과장',30,
    
    TO_DATE (SYSDATE, 'YYYY-MM-DD HH24:MI:SS'));
    
    SELECT EMPNO FROM SALE GROUP BY EMPNO;
    SELECT EMPNO, YEAR FROM SALE GROUP BY EMPNO, YEAR;
    SELECT EMPNO, COUNT(*)AS 판매건수 FROM SALE GROUP BY EMPNO;
    SELECT EMPNO, SUM(PRICE) AS 합계 FROM SALE GROUP BY EMPNO;
    SELECT EMPNO, YEAR, SUM(PRICE) AS 평균 FROM SALE GROUP BY EMPNO , YEAR;
   
    SELECT EMPNO, YEAR, SUM(PRICE) AS 합계
    FROM SALE 
    WHERE PRICE >= 50000 
    GROUP BY EMPNO , YEAR
    HAVING SUM(PRICE) >= 20000
    ORDER BY SUM(PRICE) DESC;
    
    SELECT EMPNO, SUM(PRICE) AS 합계
    FROM Sale GROUP BY EMPNO HAVING 합계 >= 200000;
    SELECT EMPNO, MONTH, PRICE FROM SALE WHERE YEAR = 2023
    UNION SELECT EMPNO, MONTH, PRICE FROM SALE WHERE YEAR = 2024;
    
    SELECT EMPNO FROM SALE WHERE YEAR =2023 INTERSECT
    SELECT EMPNO FROM SALE WHERE YEAR =2024;
    SELECT EMPNO FROM SALE WHERE YEAR = 2023
    MINUS SELECT EMPNO FROM SALE WHERE YEAR = 2024;
    
    SELECT * FROM
    EMP E 
    JOIN DEPT D 
    ON E.DEPTNO = D.DEPTNO;
    
    
    SELECT * FROM 
    FROM EMP E, DEPT D 
    WHERE E.DEPTNO = D.DEPTNO;
    
    SELECT
    S.NO,
    S.EMPNO,
    E.NAME,
    E.JOB,
    E.REGDATE,
    E.DEPTNO,
    D.DNAME
    FROM SALE S
    JOIN EMP E ON S.EMPNO = E.EMPNO
    JOIN DEPT D ON E.DEPTNO = D.DEPTNO
    WHERE PRICE > 100000 AND YEAR = 2024
    ORDER BY S.PRICE DESC;
    
    SELECT 
    * 
    FROM SALE S
    LEFT JOIN FROM EMP WHERE EMPNO = 1006;
    
    SELECT 
    * 
    FROM SALE S
    RIGHT JOIN EMP E ON S.EMPNO = E.EMPNO ;
    
    